<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>abc.html</title>
</head>

<body>
    <script>
        let uemail = "";
        // Function to get URL parameters
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Get UID and name from URL parameters
        var uid = getParameterByName('uid');

        // Display UID and name on the page
        document.write('<p>UID: ' + uid + '</p>');
     
        console.log(uid);
    </script>




    <h1>Random Task Viewer</h1>
    <p id="taskDisplay"></p>
    <button onclick="showRandomTask()">Show Another Task</button>

    <script>
        let lastTask = 0;
        // Function to fetch JSON data from data.json
        async function fetchData() {
            const response = await fetch('data.json');
            const data = await response.json();
            return data.tasks;
        }

        // Shuffle function to shuffle the tasks
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        let tasks = [];
        let shuffledTasks = [];
        let currentTaskIndex = 0;

        // Function to show a random task
        async function showRandomTask() {
            if (currentTaskIndex === 0 || currentTaskIndex === tasks.length) {
                // First time loading or after all tasks have been shown, fetch new tasks
                tasks = await fetchData();
                shuffledTasks = [...tasks];
                shuffle(shuffledTasks);
                currentTaskIndex = 0;
            }

            // Display the task
            const taskDisplay = document.getElementById('taskDisplay');
            taskDisplay.textContent = shuffledTasks[currentTaskIndex];
            lastTask = shuffledTasks[currentTaskIndex];
            // Increment the index for the next task
            currentTaskIndex += 1;
        }

        // Initial load
        showRandomTask();
    </script>

    <input type="text" name="textans" id="textans">
    <button type="submit" onclick="showtext()">
        Click
    </button>
    <script>
        function showtext(){
            let textdis=document.getElementById('textans');
            text1=textdis.value;
            console.log(text1);
        }
    </script>






    <br><br><br>
    <input type="file" accept="image/*">
    <img src="" alt="">
    <script>
        let url = "https://script.google.com/macros/s/AKfycbxaC1AQmphNpkXIfjrUWa82tKPehqPSyZq-GswrnZHFczhKKVRPqA2LrhDxu8_GttTjow/exec";
        let file = document.querySelector("input");
        let img = document.querySelector("img");
        
        file.addEventListener('change', () => {
            let t = new Date().toLocaleTimeString();
            let fr = new FileReader();
            console.log(uid);
            fr.addEventListener('loadend', () => {
                let res = fr.result;
                img.src = res;
                let spt = res.split("base64,")[1];
                // console.log(spt);
                let obj = {
                    base64: spt,
                    type: file.files[0].type,
                    // name: file.files[0].name
                    name: uid,
                    time: t,
                    tasktodisplay: lastTask,
                    textans:text1
                }
                console.log(obj);
                fetch(url, {
                    method: "POST",
                    body: JSON.stringify(obj)
                }).then(r => r.text()).then(data => console.log(data))
            })
            fr.readAsDataURL(file.files[0]);
        })
    </script>
</body>

</html>